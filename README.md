# ë‹¤ì´ì–´ë¦¬

## í”„ë¡œì íŠ¸ ì†Œê°œ
ì¼ê¸°ì¥ì„ ë§Œë“¤ì–´ ì¼ê¸°ë¥¼ ê´€ë¦¬í•´ë³¸ë‹¤.

> í”„ë¡œì íŠ¸ ê¸°ê°„: 2022-08-16 ~ 2022-09-02</br>
> íŒ€ì›: [íœ´](https://github.com/Hugh-github), [ë°ë¦­](https://github.com/derrickkim0109) </br>
ë¦¬ë·°ì–´: [ì½˜](https://github.com/protocorn93)</br>


## ğŸ“‘ ëª©ì°¨

- [ğŸ§‘ğŸ»â€ğŸ’»ğŸ§‘ğŸ»â€ğŸ’» ê°œë°œì ì†Œê°œ](#-ê°œë°œì-ì†Œê°œ)
- [â± TimeLine](#-TimeLine)
- [ğŸ’¡ í‚¤ì›Œë“œ](#-í‚¤ì›Œë“œ)
- [ğŸ¤” í•µì‹¬ê²½í—˜](#-í•µì‹¬ê²½í—˜)
- [ğŸ“± ì‹¤í–‰ í™”ë©´](#-ì‹¤í–‰-í™”ë©´)
- [ğŸ—‚ í´ë” êµ¬ì¡°](#-í´ë”-êµ¬ì¡°)
- [ğŸ“ ê¸°ëŠ¥ì„¤ëª…](#-ê¸°ëŠ¥ì„¤ëª…)
- [ğŸš€ TroubleShooting](#-TroubleShooting)
- [ğŸ“š ì°¸ê³ ë¬¸ì„œ](#-ì°¸ê³ ë¬¸ì„œ)


## ğŸ§‘ğŸ»â€ğŸ’»ğŸ§‘ğŸ»â€ğŸ’» ê°œë°œì ì†Œê°œ

|Hugh|ë°ë¦­|
|:---:|:---:|
||<image src = "https://avatars.githubusercontent.com/u/59466342?v=4" width="250" height="250">
|[Hugh](https://github.com/Hugh-github)|[ë°ë¦­](https://github.com/derrickkim0109)|

## â± TimeLine

### Week 1
    
> 2022.08.16 ~ 2022.08.19
    
- 2022.08.16 
    - JSON íŒŒì¼ì„ ì²˜ë¦¬í•˜ëŠ” íƒ€ì… 
    - JSON Data ë°›ì„ Model íƒ€ì…
    - Unit Test ì‘ì„±

- 2022.08.17
    - DateFormatterë¡œ í˜„ì¬ ë‚ ì§œ êµ¬í˜„
    - TextViewì—ì„œ Keyboard í˜¸ì¶œ ì‹œ í‚¤ë³´ë“œ ë†’ì´ì— ë§ê²Œ ì„¤ì •
    - Step01 PR
    
- 2022.08.18
    - SwiftLint ì„¤ì •
    
- 2022.08.19
    - Step01 ë¦¬íŒ©í† ë§
    
### Week 2
    
> 2022.08.22 ~ 2022.08.26
    
- 2022.08.22 
    - MVVMì— ëŒ€í•œ ê³µë¶€
    - NotificationCenterë¥¼ í™œìš©í•œ ë°ì´í„° ì „í™˜
    - CoreData CRUD
    
- 2022.08.23
    - ê°ì²´ ì§€í–¥ì— ëŒ€í•œ ì±… ì½ê¸° 
    
- 2022.08.24
    - AlertView 
    - Activity View
    - Navigation Bar Button
    - TableView ìŠ¤ì™€ì´í”„ë¥¼ í†µí•œ ì‚­ì œ ê¸°ëŠ¥
    
- 2022.08.25
    - Navigation Bar Done Button ë²„íŠ¼ ì¶”ê°€
    - ì €ì¥ ë¡œì§ ì—ëŸ¬ ìˆ˜ì • 
    - Step02 PR
    
- 2022.08.26
    - ê°ì²´ ì§€í–¥ì— ëŒ€í•œ ì±… ì½ê¸° 
    
## ğŸ’¡ í‚¤ì›Œë“œ

- `DateFormatter`, `UITableViewDiffableDataSource`, `UITableView`, 
    `UITextView`, `Date`, `JSON`, `AlertViewController`, `CoreData`,     `CRUD`, `Activity View`, `Navigation Bar Button` 
    
## ğŸ¤” í•µì‹¬ê²½í—˜

- [x] Date Formatterì˜ ì§€ì—­ ë° ê¸¸ì´ë³„ í‘œí˜„ì˜ í™œìš©
- [x] Text Viewì˜ í™œìš©
- [x] ì½”ì–´ë°ì´í„° ëª¨ë¸ ìƒì„±
- [x] ì½”ì–´ë°ì´í„° ëª¨ë¸ ë° DB ë§ˆì´ê·¸ë ˆì´ì…˜
- [x] í…Œì´ë¸”ë·°ì—ì„œ ìŠ¤ì™€ì´í”„ë¥¼ í†µí•œ ì‚­ì œê¸°ëŠ¥ êµ¬í˜„
- [ ] Text View Delegateì˜ í™œìš©
- [ ] Open APIì˜ í™œìš©
- [ ] Core Locationì˜ í™œìš©

## ğŸ“± ì‹¤í–‰ í™”ë©´

|ì¼ê¸°ì¥ List í™”ë©´|ì¼ê¸°ì¥ í™”ë©´|ì¼ê¸°ì¥ ì‘ì„± í™”ë©´|í‚¤ë³´ë“œ êµ¬í˜„|
|:--:|:--:|:--:|:--:|
|![](https://i.imgur.com/uoXp233.gif)|![](https://i.imgur.com/ikYAfoW.gif)|![](https://i.imgur.com/NtY72xL.gif)|![](https://i.imgur.com/oDd8BZH.gif)|

|ì¼ê¸°ì¥ ìƒì„±|ì¼ê¸°ì¥ ìˆ˜ì •|í‚¤ë³´ë“œ ì‚¬ë¼ì§|
|:--:|:--:|:--:|
|![](https://i.imgur.com/PulaOBC.gif)|![](https://i.imgur.com/4G7BY6L.gif)|![](https://i.imgur.com/Ampe36t.gif)|
    

|Shared|Delete|Swipe Delete|ë°±ê·¸ë¼ìš´ë“œ ì €ì¥|
|:--:|:--:|:--:|:--:|
|![](https://i.imgur.com/LkU2vHk.gif)|![](https://i.imgur.com/ia4ZKUB.gif)|![](https://i.imgur.com/qEBa0vo.gif)|![](https://i.imgur.com/9PhyqAa.gif)|

    
## ğŸ—‚ í´ë” êµ¬ì¡°

```
â””â”€â”€ Diary
    â”œâ”€â”€ Diary.xcdatamodeld
    â”œâ”€â”€ Application
    â”‚   â”œâ”€â”€ AppDelegate
    â”‚   â””â”€â”€ SceneDelegate
    â”œâ”€â”€ ViewModel
    â”‚   â””â”€â”€ DiaryViewModel
    â”œâ”€â”€ View
    â”‚   â”œâ”€â”€ DiaryPost
    â”‚   â”‚   â””â”€â”€ DiaryPostViewController
    â”‚   â”œâ”€â”€ DiaryContent
    â”‚   â”‚   â””â”€â”€ DiaryContentViewController
    â”‚   â””â”€â”€ DiaryList
    â”‚       â”œâ”€â”€ DiaryListViewController
    â”‚       â””â”€â”€ DiaryTableViewCell
    â”œâ”€â”€ Model
    â”‚   â””â”€â”€ DiaryContent
    â”œâ”€â”€ JSON
    â”‚   â”œâ”€â”€ JSONManager
    â”‚   â””â”€â”€ JSONError
    â”œâ”€â”€ Extensions
    â”‚   â”œâ”€â”€ TimeInterval+Extensions
    â”‚   â”œâ”€â”€ Date+Extensions
    â”‚   â””â”€â”€ UITextView+Extensions
    â”œâ”€â”€ Resources
    â”‚   â”œâ”€â”€ Assets
    â”‚   â”œâ”€â”€ LaunchScreen
    â”‚   â””â”€â”€ Info
    â””â”€â”€ DiaryTests
        â””â”€â”€ DiaryTests
```

    
## ğŸ“ ê¸°ëŠ¥ì„¤ëª…

**ì¼ê¸°ì¥ UI êµ¬í˜„**
- TableView
    - ìŠ¤ì™€ì´í”„ë¥¼ ì´ìš©í•´ list ì œê±° ê¸°ëŠ¥ ì œê³µ
- StackView
- TextView
    - í‚¤ë³´ë“œ ê¸¸ì´ì— ë§ê²Œ TextView ë†’ì´ ì¡°ì ˆ ê¸°ëŠ¥ ì œê³µ

**í™”ë©´ ì „í™˜ì‹œ ë°ì´í„° ì „ë‹¬**
- ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë°ì´í„° ì „ë‹¬
    
**ì¼ê¸°ì¥ í™”ë©´ì˜ Text View & í‚¤ë³´ë“œ**
- í˜„ì¬ ì»¤ì„œë¡œ textViewë¥¼ í´ë¦­í•˜ëŠ” ìœ„ì¹˜ê°€ í‚¤ë³´ë“œì— ê°€ë ¤ì§€ì§€ ì•Šë„ë¡ êµ¬í˜„
- í˜„ì¬ ì‚¬ìš©ìê°€ ì‘ì„±í•˜ëŠ” ë¶€ë¶„ì€ í™”ë©´ì— ë³´ì´ë„ë¡ êµ¬í˜„
    
**ì¼ê¸°ì¥ ë°ì´í„° ì €ì¥**
- ë°±ê·¸ë¼ìš´ë“œ ì§„ì…ì‹œ 
- Content Viewì—ì„œ ë’¤ë¡œê°€ê¸°
- ì‚¬ìš©ìê°€ ì…ë ¥ì„ ë©ˆì¶”ëŠ” ê²½ìš°(í‚¤ë³´ë“œê°€ ì‚¬ë¼ì§€ëŠ” ê²½ìš°) - ì™„ë£Œ ë²„íŠ¼ í´ë¦­ì‹œ
    
**ì¼ê¸°ì¥ Navigation Bar Button Item**
- ellipsis ë²„íŠ¼ (**â‹¯**) : í•´ë‹¹ í…ìŠ¤íŠ¸ë¥¼ ê³µìœ í•˜ëŠ” í™”ë©´ê³¼ ì‚­ì œ ê¸°ëŠ¥ì„ ì œê³µ 
- ì™„ë£Œ ë²„íŠ¼ : í‚¤ë³´ë“œë¡œ ë‚´ìš© ì…ë ¥ í›„ ì™„ë£Œ ë²„íŠ¼ í´ë¦­ ì‹œ í‚¤ë³´ë“œ ë‚´ë¦¼ ê¸°ëŠ¥ ì œê³µ 

## ğŸš€ TroubleShooting
    
### STEP 1

#### T1. `UITableViewDiffableDataSource`ì˜ ì‚¬ìš©ë°©ë²•
    - ë°ì´í„°ë¥¼ snapshotì—ì„œ ë°›ì•„ UI Updateê°€ ì‘ë™í•´ì•¼í•˜ëŠ” ìƒí™©ì´ë‚˜ ë°ì´í„°ë¥¼ ë°›ì§€ ëª»í•´ì„œ ë°œìƒí•œ ë¬¸ì œ
    
```swift 
    private func fetchData() {
    let fileName = "diarySample"
    let result = jsonManager.checkFileAndDecode(dataType: [DiaryContent].self, fileName)

    switch result {
    case .success(let contents):
        diaryContents = contents
        updateDataSource(data: contents)
    case .failure(_):
        break
    default:
        break
    }
}

private func updateDataSource(data: [DiaryContent]) {
    var snapshot = NSDiffableDataSourceSnapshot<Section, DiaryContent>()
    snapshot.appendSections([.main])
    snapshot.appendItems(data)

    dataSource?.apply(snapshot)
}
```
- ë°ì´í„°ë¥¼ ë¨¼ì € ë°›ì•„ì˜¨ í›„ snapshotì„ ì—…ë°ì´íŠ¸ í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
    
    
#### T2. TextViewì˜ ìŠ¤í¬ë¡¤ë·° 
    - Text Viewì˜ heigthê°€ í´ ê²½ìš° ì œëª©ì´ ì‚¬ë¼ì§€ëŠ” í˜„ìƒ ë°œìƒ
```swift!
extension UITextView {
    func focusTop() {
        let contentHeight = self.contentSize.height
        let offSet = self.contentOffset.y
        let contentOffset = contentHeight - offSet
        self.contentOffset = CGPoint(x: 0, y: -contentOffset)
    }
}
```

#### T3. ê°„ì ‘ì ìœ¼ë¡œ ì²˜ë¦¬í–ˆë˜ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì„ ì§ì ‘ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ë„ë¡ êµ¬í˜„
    (ViewController â†”ï¸ ViewModel ( â†”ï¸ Business logic object ))
```Swift!
final class DiaryViewModel {
    private let jsonManager = JSONManager()
    var diaryContents: [DiaryContent] {
        guard let contents = fetchData() else {
            return [DiaryContent]()
        }

        return contents
    }


    private func fetchData() -> [DiaryContent]? {
        let fileName = "diarySample"
        let result = jsonManager.checkFileAndDecode(dataType : [DiaryContent].self, fileName)

        switch result {
        case .success(let contents):
            return contents
        default:
            return nil
        }
    }
}
```
- ViewController ë‚´ì—ì„œ `fetchData()ë¥¼ ì²˜ë¦¬í•˜ì˜€ìœ¼ë‚˜ ViewModelë¡œ ì´ë™.
    - ì´ìœ  : MVVM íŒ¨í„´ì—ì„œ ViewControllerëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ë©´ ì•ˆë˜ê¸° ë•Œë¬¸.

### STEP 2

#### T1. titleê³¼ bodyë¥¼ ë¶„ë¦¬í•˜ëŠ” ë¡œì§
- ì¼ê¸°ì¥ì„ ìƒì„±í•˜ëŠ” `DiaryPostViewController`ì—ì„œ `TextView` ë‚´ì— í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥ì‹œ ì²˜ë¦¬í•´ì¤˜ì•¼ í•˜ëŠ” ë¬¸ì œë“¤ì´ ìˆì—ˆìŠµë‹ˆë‹¤.
    1. ì œëª©ì„ ì‘ì„±í•˜ê³  í•œì¹¸ ë„ì›Œì“°ê¸°("\n\n")ë¥¼ í•˜ê³  ë‚´ìš©ì„ ì‘ì„±
    2. ë°”ë¡œ ì•„ë˜ë¼ì¸("\n")ìœ¼ë¡œ ë‚´ìš©ì„ ì‘ì„±í•˜ëŠ” ìƒí™©

```swift

var data = text.split(separator: "\n", maxSplits: 2).map{ String($0) }
let title = data.remove(at: 0)
let body = data.count >= 1 ? data.joined(separator: "\n") : ""

```
- TextViewì˜ í…ìŠ¤íŠ¸ë¥¼ ëª¨ë‘ ë°›ì•„ì™€ Title ë¶€ë¶„ê³¼ ë¶„ë¦¬í•˜ì—¬ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤. 
 
#### T2. CoreData Update
- í•´ë‹¹ Cellì„ í†µí•´ textë¥¼ ìˆ˜ì •í•´ë„ ìˆ˜ì •ì´ ì œëŒ€ë¡œ ë°˜ì˜ë˜ì§€ ì•Šê³ , ë‹¤ë¥¸ Cellì´ updateë˜ëŠ” ê±¸ í™•ì¸ ìƒì„± ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ ì›í•˜ëŠ” í•´ë‹¹ Cellì˜ ì •í™•í•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ë„ë¡ ìˆ˜ì •
```swift
request.predicate = NSPredicate(format: "createdAt = %@", "\(data.createdAt)")
```


## ğŸ“š ì°¸ê³ ë¬¸ì„œ

- [UITextView](https://developer.apple.com/documentation/uikit/uitextview)
- [UITableViewDiffableDataSource](https://developer.apple.com/documentation/uikit/uitableviewdiffabledatasource)
- [DateFormatter](https://developer.apple.com/documentation/foundation/dateformatter)